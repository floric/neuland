<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>html, body {
  margin: 0;
  padding: 0;
}

.app {
  margin: 10px;
  padding: 0;
}

.files-list {
  margin: 10px 0 0;
  width: 100%;
  border-collapse: collapse;
}
.files-list__head {
  border: 1px solid #999;
}
.files-list__head > tr > th {
  padding: 10px;
  border: 1px solid #999;
  text-align: left;
  font-weight: normal;
  background: #ddd;
}
.files-list__body {
}
.files-list__file {
  cursor: pointer;
}
.files-list__file:hover {
  background: #ccf;
}
.files-list__file > td {
  padding: 10px;
  border: 1px solid #999;
}
.files-list__file > td:first-child::before {
  content: '\01F4C4';
  margin-right: 1em;
}
.files-list__file_low {
  background: #fcc;
}
.files-list__file_medium {
  background: #ffc;
}
.files-list__file_high {
  background: #cfc;
}
.files-list__file_folder > td:first-child::before {
  content: '\01F4C1';
  margin-right: 1em;
}

.file-header {
  border: 1px solid #999;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.file-header__back {
  margin: 10px;
  cursor: pointer;
  flex-shrink: 0;
  flex-grow: 0;
  text-decoration: underline;
  color: #338;
}

.file-header__name {
  margin: 10px;
  flex-shrink: 2;
  flex-grow: 2;
}

.file-header__stat {
  margin: 10px;
  flex-shrink: 0;
  flex-grow: 0;
}

.file-content {
  margin: 10px 0 0;
  border: 1px solid #999;
  padding: 10px;
}

.code-line {
  margin: 0;
  padding: 0.3em;
  height: 1em;
}
.code-line_covered {
  background: #cfc;
}
.code-line_uncovered {
  background: #fcc;
}
</style>
</head>
<body>
    <div id="root"></div>
    <script>
        var data = {"files":[{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","attributes.rs"],"content":"use std::collections::HashMap;\nuse std::hash::{Hash, Hasher};\n\n#[derive(Default, Clone, Eq)]\npub struct Attributes {\n    values: HashMap\u003cString, String\u003e,\n}\n\nimpl Attributes {\n    pub fn value_count(\u0026self) -\u003e usize {\n        self.values.len()\n    }\n\n    pub fn get(\u0026self, key: \u0026str) -\u003e Option\u003c\u0026String\u003e {\n        self.values.get(key)\n    }\n\n    pub fn set(\u0026mut self, key: \u0026str, value: String) {\n        self.values.insert(key.to_string(), value);\n    }\n\n    pub fn remove(\u0026mut self, key: \u0026str) {\n        self.values.remove(key);\n    }\n}\n\nimpl Hash for Attributes {\n    fn hash\u003cH: Hasher\u003e(\u0026self, hasher: \u0026mut H) {\n        for att in self.values.iter() {\n            att.hash(hasher);\n        }\n    }\n}\n\nimpl PartialEq for Attributes {\n    fn eq(\u0026self, other: \u0026Self) -\u003e bool {\n        other.values.eq(\u0026self.values)\n    }\n}\n","traces":[{"line":10,"address":[4575200],"length":1,"stats":{"Line":1},"fn_name":"value_count"},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[4517840],"length":1,"stats":{"Line":2},"fn_name":"get"},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[4575424],"length":1,"stats":{"Line":3},"fn_name":"set"},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[4575584],"length":1,"stats":{"Line":1},"fn_name":"remove"},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":5,"coverable":13},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","edge.rs"],"content":"use super::attributes::Attributes;\nuse nanoid::nanoid;\nuse std::hash::Hash;\n\n#[derive(Clone, Hash, PartialEq, Eq)]\npub struct Edge {\n    id: String,\n    relation: String,\n    from: String,\n    to: String,\n    attributes: Attributes,\n}\n\nimpl Edge {\n    pub fn new(relation: String, from: String, to: String, attributes: Attributes) -\u003e Edge {\n        Edge {\n            id: nanoid!(),\n            relation,\n            from,\n            to,\n            attributes,\n        }\n    }\n\n    pub fn id(\u0026self) -\u003e \u0026String {\n        \u0026self.id\n    }\n\n    pub fn relation(\u0026self) -\u003e \u0026String {\n        \u0026self.relation\n    }\n\n    pub fn from_id(\u0026self) -\u003e \u0026String {\n        \u0026self.from\n    }\n\n    pub fn to_id(\u0026self) -\u003e \u0026String {\n        \u0026self.to\n    }\n\n    pub fn attributes(\u0026self) -\u003e \u0026Attributes {\n        \u0026self.attributes\n    }\n}\n","traces":[{"line":15,"address":[4567328],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":17,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[4567584],"length":1,"stats":{"Line":0},"fn_name":"relation"},{"line":30,"address":[4545388],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[4574720],"length":1,"stats":{"Line":1},"fn_name":"from_id"},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[4567616],"length":1,"stats":{"Line":1},"fn_name":"to_id"},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":5,"coverable":12},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","graph","mod.rs"],"content":"mod util;\n\nuse super::Attributes;\nuse super::Edge;\nuse super::Node;\nuse std::collections::HashMap;\nuse std::option::Option;\n\n#[derive(Default)]\npub struct Graph {\n    nodes: HashMap\u003cString, Node\u003e,\n    edges: HashMap\u003cString, Edge\u003e,\n    relations: HashMap\u003cString, HashMap\u003cString, String\u003e\u003e,\n}\n\nimpl Graph {\n    pub fn node_count(\u0026self) -\u003e usize {\n        self.nodes.len()\n    }\n\n    pub fn get_node(\u0026self, id: \u0026str) -\u003e Option\u003c\u0026Node\u003e {\n        self.nodes.get(id)\n    }\n\n    pub fn create_node(\u0026mut self, attributes: Attributes) -\u003e \u0026Node {\n        let n = Node::new(attributes);\n        let node_id = n.id().clone();\n        self.nodes.insert(n.id().clone(), n);\n        self.get_node(\u0026node_id).unwrap()\n    }\n\n    pub fn find_by_attribute(\u0026self, key: \u0026str, value: \u0026str) -\u003e Vec\u003c\u0026Node\u003e {\n        self.nodes\n            .values()\n            .filter(|node| -\u003e bool {\n                node.attributes()\n                    .get(key)\n                    .filter(|entry| -\u003e bool { *entry == value })\n                    .is_some()\n            })\n            .collect::\u003cVec\u003c\u0026Node\u003e\u003e()\n    }\n}\n\nimpl Graph {\n    pub fn edge_count(\u0026self) -\u003e usize {\n        self.edges.len()\n    }\n\n    pub fn get_edge(\u0026self, id: \u0026str) -\u003e Option\u003c\u0026Edge\u003e {\n        self.edges.get(id)\n    }\n\n    pub fn create_edge(\n        \u0026mut self,\n        relation: \u0026str,\n        attributes: Attributes,\n        source_id: \u0026str,\n        destination_id: \u0026str,\n    ) -\u003e \u0026Edge {\n        let e = Edge::new(\n            String::from(relation),\n            String::from(source_id),\n            String::from(destination_id),\n            attributes,\n        );\n        let edge_id = e.id().clone();\n        self.edges.insert(e.id().clone(), e);\n\n        let edge = self.edges.get(\u0026edge_id).unwrap();\n\n        let connection_key = util::build_relation_key(source_id, destination_id);\n        let relations_map = self\n            .relations\n            .entry(connection_key)\n            .or_insert_with(HashMap::new);\n\n        relations_map.insert(String::from(relation), edge_id);\n\n        edge\n    }\n\n    pub fn remove_edge(\u0026mut self, edge_id: \u0026str) {\n        let removed_edge = self.edges.remove(edge_id).unwrap();\n        let relation_key = util::build_relation_key(removed_edge.from_id(), removed_edge.to_id());\n        let relations = self.relations.get_mut(\u0026relation_key).unwrap();\n        relations.remove(removed_edge.relation());\n        if relations.is_empty() {\n            self.relations.remove(\u0026relation_key);\n        }\n    }\n\n    pub fn has_any_relation(\u0026self, source_id: \u0026str, destination_id: \u0026str) -\u003e bool {\n        let relation_key = util::build_relation_key(source_id, destination_id);\n        self.relations.contains_key(\u0026relation_key)\n            \u0026\u0026 !self.relations.get(\u0026relation_key).unwrap().is_empty()\n    }\n\n    pub fn has_relation(\u0026self, relation: \u0026str, source_id: \u0026str, destination_id: \u0026str) -\u003e bool {\n        let relation_key = util::build_relation_key(source_id, destination_id);\n        self.relations.contains_key(\u0026relation_key)\n            \u0026\u0026 self\n                .relations\n                .get(\u0026relation_key)\n                .unwrap()\n                .contains_key(relation)\n    }\n}\n","traces":[{"line":17,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":21,"coverable":54},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","graph","util.rs"],"content":"pub fn build_relation_key(source_id: \u0026str, destination_id: \u0026str) -\u003e String {\n    format!(\"{}-{}\", source_id, destination_id)\n}\n\n#[cfg(test)]\nmod tests {\n    #[test]\n    fn test_create_key() {\n        let key = super::build_relation_key(\"a\", \"b\");\n        assert_eq!(\"a-b\", key);\n    }\n\n    #[test]\n    fn test_direction_of_key() {\n        assert_ne!(\n            super::build_relation_key(\"a\", \"b\"),\n            super::build_relation_key(\"b\", \"a\")\n        );\n    }\n}\n","traces":[{"line":1,"address":[4517280],"length":1,"stats":{"Line":0},"fn_name":"build_relation_key"},{"line":2,"address":[4212525,4212999,4212613,4213144,4212918],"length":1,"stats":{"Line":16},"fn_name":null},{"line":8,"address":[4212357,4212464,4212352],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":10,"address":[4212668,4212706,4212800],"length":1,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[4212341,4212848,4212336],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":15,"address":[4213282,4213378,4213212],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":5,"coverable":6},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","node.rs"],"content":"use super::attributes::Attributes;\nuse nanoid::nanoid;\nuse std::hash::Hash;\n\n#[derive(Clone, Hash, PartialEq, Eq)]\npub struct Node {\n    id: String,\n    attributes: Attributes,\n}\n\nimpl Node {\n    pub fn new(attributes: Attributes) -\u003e Node {\n        Node {\n            id: nanoid!(),\n            attributes,\n        }\n    }\n\n    pub fn id(\u0026self) -\u003e \u0026String {\n        \u0026self.id\n    }\n\n    pub fn attributes(\u0026self) -\u003e \u0026Attributes {\n        \u0026self.attributes\n    }\n}\n","traces":[{"line":12,"address":[4539952],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":14,"address":[4541710],"length":1,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[4540112],"length":1,"stats":{"Line":0},"fn_name":"attributes"},{"line":24,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":3,"coverable":6},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","tests","attributes.rs"],"content":"use neuland::model::Attributes;\n\n#[test]\nfn test_attributes_creation() {\n    let attributes = Attributes::default();\n\n    assert_eq!(0, attributes.value_count());\n}\n\n#[test]\nfn test_set_and_get_value() {\n    let mut attributes = Attributes::default();\n    attributes.set(\"a\", String::from(\"b\"));\n\n    assert_eq!(attributes.get(\"a\").unwrap(), \"b\");\n}\n\n#[test]\nfn test_unknown_value() {\n    let mut attributes = Attributes::default();\n    attributes.set(\"x\", String::from(\"y\"));\n\n    assert!(attributes.get(\"a\").is_none());\n}\n\n#[test]\nfn test_remove_value() {\n    let mut attributes = Attributes::default();\n    attributes.set(\"a\", String::from(\"b\"));\n    attributes.remove(\"a\");\n\n    assert!(attributes.get(\"a\").is_none());\n}\n","traces":[{"line":4,"address":[4213973,4213968],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":7,"address":[4216387,4216454,4216577],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[4214000,4214005],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":13,"address":[4216828],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4217050,4216891,4216859,4216945,4216914],"length":1,"stats":{"Line":3},"fn_name":null},{"line":19,"address":[4213984,4213989],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":21,"address":[4217352],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[4217459,4217380,4217406],"length":1,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[4214016,4214021],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":29,"address":[4217720],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[4217748],"length":1,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[4217850,4217771,4217797],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":12,"coverable":12},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","tests","find.rs"],"content":"use neuland::model::Attributes;\nuse neuland::model::Graph;\n\n#[test]\nfn test_node_find_by_attributes() {\n    let mut graph = Graph::default();\n    let mut attributes_a = Attributes::default();\n    attributes_a.set(\"test\", String::from(\"a\"));\n    let mut attributes_b = Attributes::default();\n    attributes_b.set(\"test\", String::from(\"b\"));\n    let node_a = graph.create_node(attributes_a).clone();\n    let node_b = graph.create_node(attributes_b).clone();\n    let node_c = graph.create_node(Attributes::default()).clone();\n\n    let matches = graph.find_by_attribute(\"test\", \"a\");\n    assert_eq!(1, matches.len());\n    assert!(matches.contains(\u0026\u0026node_a));\n    assert!(!matches.contains(\u0026\u0026node_b));\n    assert!(!matches.contains(\u0026\u0026node_c));\n}\n","traces":[{"line":5,"address":[4216336,4216341,4216352],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":6,"address":[4216373],"length":1,"stats":{"Line":1},"fn_name":null},{"line":8,"address":[4216564],"length":1,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[4216781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[4216818],"length":1,"stats":{"Line":1},"fn_name":null},{"line":12,"address":[4217032],"length":1,"stats":{"Line":1},"fn_name":null},{"line":13,"address":[4217335],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4217463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":16,"address":[4217518,4218077,4218210],"length":1,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[4217605,4218233,4217552],"length":1,"stats":{"Line":2},"fn_name":null},{"line":18,"address":[4218259,4217629,4217677],"length":1,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[4218285,4217701,4217749],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":12,"coverable":12},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","tests","graph.rs"],"content":"use neuland::model::Attributes;\nuse neuland::model::Graph;\n\n#[test]\nfn test_graph_creation() {\n    let graph = Graph::default();\n\n    assert_eq!(0, graph.node_count());\n}\n\n#[test]\nfn test_node_creation() {\n    let mut graph = Graph::default();\n    let node_a = graph.create_node(Attributes::default()).clone();\n    let node_b = graph.create_node(Attributes::default()).clone();\n\n    assert_eq!(21, node_a.id().len());\n    assert_eq!(21, node_b.id().len());\n    assert_ne!(node_a.id(), node_b.id());\n    assert_eq!(2, graph.node_count());\n    assert!(!graph.has_any_relation(node_a.id(), node_b.id()));\n}\n\n#[test]\nfn test_edge_creation() {\n    let mut graph = Graph::default();\n\n    let node_a = graph.create_node(Attributes::default()).clone();\n    let node_b = graph.create_node(Attributes::default()).clone();\n    let edge_a = graph\n        .create_edge(\"rel-a\", Attributes::default(), node_a.id(), node_b.id())\n        .clone();\n    graph.create_edge(\"rel-b\", Attributes::default(), node_a.id(), node_b.id());\n\n    assert!(graph.has_any_relation(node_a.id(), node_b.id()));\n    assert!(!graph.has_any_relation(node_b.id(), node_a.id()));\n    assert!(!graph.has_any_relation(node_a.id(), node_a.id()));\n    assert!(graph.has_relation(\"rel-a\", node_a.id(), node_b.id()));\n    assert!(graph.has_relation(\"rel-b\", node_a.id(), node_b.id()));\n    assert!(!graph.has_relation(\"rel-c\", node_a.id(), node_b.id()));\n    assert_eq!(21, edge_a.id().len());\n    assert_eq!(node_a.id(), edge_a.from_id());\n    assert_eq!(node_b.id(), edge_a.to_id());\n    assert_eq!(2, graph.node_count());\n    assert_eq!(2, graph.edge_count());\n}\n\n#[test]\nfn test_edge_removal() {\n    let mut graph = Graph::default();\n\n    let node_a = graph.create_node(Attributes::default()).clone();\n    let node_b = graph.create_node(Attributes::default()).clone();\n    let edge = graph\n        .create_edge(\"rel-a\", Attributes::default(), node_a.id(), node_b.id())\n        .clone();\n    graph.create_edge(\"rel-b\", Attributes::default(), node_a.id(), node_b.id());\n    graph.remove_edge(edge.id());\n\n    assert!(!graph.has_relation(\"rel-a\", node_a.id(), node_b.id()));\n    assert!(graph.has_relation(\"rel-b\", node_a.id(), node_b.id()));\n    assert_eq!(2, graph.node_count());\n    assert_eq!(1, graph.edge_count());\n    assert!(graph.has_any_relation(node_a.id(), node_b.id()));\n}\n","traces":[{"line":5,"address":[4215104,4215120,4215109],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":6,"address":[4215133],"length":1,"stats":{"Line":1},"fn_name":null},{"line":8,"address":[4215204,4215310,4215141],"length":1,"stats":{"Line":1},"fn_name":null},{"line":12,"address":[4215413,4215408,4215424],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":13,"address":[4215444],"length":1,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[4215574],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4215836],"length":1,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[4216425,4216528,4215988,4215998],"length":1,"stats":{"Line":2},"fn_name":null},{"line":18,"address":[4216551,4216018,4216028,4216654],"length":1,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[4216781,4216685,4216051,4216117],"length":1,"stats":{"Line":2},"fn_name":null},{"line":20,"address":[4216907,4216131,4216804],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[4216160,4216178,4216199,4216927],"length":1,"stats":{"Line":3},"fn_name":null},{"line":25,"address":[4217104,4217088,4217093],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":26,"address":[4217126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[4217274],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[4217563],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[4217881],"length":1,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[4217847,4220214,4217868],"length":1,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[4218068,4218047,4218081,4220196],"length":1,"stats":{"Line":3},"fn_name":null},{"line":35,"address":[4219543,4218156,4218135,4218177],"length":1,"stats":{"Line":3},"fn_name":null},{"line":36,"address":[4218247,4218226,4219572,4218205],"length":1,"stats":{"Line":3},"fn_name":null},{"line":37,"address":[4218317,4219601,4218275,4218296],"length":1,"stats":{"Line":3},"fn_name":null},{"line":38,"address":[4219630,4218379,4218366,4218345],"length":1,"stats":{"Line":3},"fn_name":null},{"line":39,"address":[4218431,4218452,4218465,4219659],"length":1,"stats":{"Line":3},"fn_name":null},{"line":40,"address":[4218551,4218517,4218538,4219688],"length":1,"stats":{"Line":3},"fn_name":null},{"line":41,"address":[4218613,4219717,4218603,4219826],"length":1,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[4218705,4219145,4218636,4219247],"length":1,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[4219278,4218788,4218719,4219380],"length":1,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[4219849,4218802,4219958],"length":1,"stats":{"Line":1},"fn_name":null},{"line":45,"address":[4219978,4220087,4218831],"length":1,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[4226933,4226928],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":50,"address":[4220342],"length":1,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[4220478],"length":1,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[4220746],"length":1,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[4221039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[4221012,4221033,4222445],"length":1,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[4221216,4221195,4222430],"length":1,"stats":{"Line":2},"fn_name":null},{"line":58,"address":[4221292,4221271],"length":1,"stats":{"Line":2},"fn_name":null},{"line":60,"address":[4221336,4222018,4221306,4221327],"length":1,"stats":{"Line":3},"fn_name":null},{"line":61,"address":[4221416,4221395,4221425,4222047],"length":1,"stats":{"Line":3},"fn_name":null},{"line":62,"address":[4222178,4222076,4221484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[4222199,4222301,4221513],"length":1,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[4221542,4221584,4221563,4222319],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":43,"coverable":43}]};
        var previousData = {"files":[{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","attributes.rs"],"content":"use std::collections::HashMap;\nuse std::hash::{Hash, Hasher};\n\n#[derive(Default, Clone, Eq)]\npub struct Attributes {\n    values: HashMap\u003cString, String\u003e,\n}\n\nimpl Attributes {\n    pub fn value_count(\u0026self) -\u003e usize {\n        self.values.len()\n    }\n\n    pub fn get(\u0026self, key: \u0026str) -\u003e Option\u003c\u0026String\u003e {\n        self.values.get(key)\n    }\n\n    pub fn set(\u0026mut self, key: \u0026str, value: String) {\n        self.values.insert(key.to_string(), value);\n    }\n\n    pub fn remove(\u0026mut self, key: \u0026str) {\n        self.values.remove(key);\n    }\n}\n\nimpl Hash for Attributes {\n    fn hash\u003cH: Hasher\u003e(\u0026self, hasher: \u0026mut H) {\n        for att in self.values.iter() {\n            att.hash(hasher);\n        }\n    }\n}\n\nimpl PartialEq for Attributes {\n    fn eq(\u0026self, other: \u0026Self) -\u003e bool {\n        other.values.eq(\u0026self.values)\n    }\n}\n","traces":[{"line":10,"address":[4575200],"length":1,"stats":{"Line":1},"fn_name":"value_count"},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[4517840],"length":1,"stats":{"Line":2},"fn_name":"get"},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[4575424],"length":1,"stats":{"Line":3},"fn_name":"set"},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[4575584],"length":1,"stats":{"Line":1},"fn_name":"remove"},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":5,"coverable":13},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","edge.rs"],"content":"use super::attributes::Attributes;\nuse nanoid::nanoid;\nuse std::hash::Hash;\n\n#[derive(Clone, Hash, PartialEq, Eq)]\npub struct Edge {\n    id: String,\n    relation: String,\n    from: String,\n    to: String,\n    attributes: Attributes,\n}\n\nimpl Edge {\n    pub fn new(relation: String, from: String, to: String, attributes: Attributes) -\u003e Edge {\n        Edge {\n            id: nanoid!(),\n            relation,\n            from,\n            to,\n            attributes,\n        }\n    }\n\n    pub fn id(\u0026self) -\u003e \u0026String {\n        \u0026self.id\n    }\n\n    pub fn relation(\u0026self) -\u003e \u0026String {\n        \u0026self.relation\n    }\n\n    pub fn from_id(\u0026self) -\u003e \u0026String {\n        \u0026self.from\n    }\n\n    pub fn to_id(\u0026self) -\u003e \u0026String {\n        \u0026self.to\n    }\n\n    pub fn attributes(\u0026self) -\u003e \u0026Attributes {\n        \u0026self.attributes\n    }\n}\n","traces":[{"line":15,"address":[4567328],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":17,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[4567584],"length":1,"stats":{"Line":0},"fn_name":"relation"},{"line":30,"address":[4545388],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[4574720],"length":1,"stats":{"Line":1},"fn_name":"from_id"},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[4567616],"length":1,"stats":{"Line":1},"fn_name":"to_id"},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":5,"coverable":12},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","graph","mod.rs"],"content":"mod util;\n\nuse super::Attributes;\nuse super::Edge;\nuse super::Node;\nuse std::collections::HashMap;\nuse std::option::Option;\n\n#[derive(Default)]\npub struct Graph {\n    nodes: HashMap\u003cString, Node\u003e,\n    edges: HashMap\u003cString, Edge\u003e,\n    relations: HashMap\u003cString, HashMap\u003cString, String\u003e\u003e,\n}\n\nimpl Graph {\n    pub fn node_count(\u0026self) -\u003e usize {\n        self.nodes.len()\n    }\n\n    pub fn get_node(\u0026self, id: \u0026str) -\u003e Option\u003c\u0026Node\u003e {\n        self.nodes.get(id)\n    }\n\n    pub fn create_node(\u0026mut self, attributes: Attributes) -\u003e \u0026Node {\n        let n = Node::new(attributes);\n        let node_id = n.id().clone();\n        self.nodes.insert(n.id().clone(), n);\n        self.get_node(\u0026node_id).unwrap()\n    }\n\n    pub fn find_by_attribute(\u0026self, key: \u0026str, value: \u0026str) -\u003e Vec\u003c\u0026Node\u003e {\n        self.nodes\n            .values()\n            .filter(|node| -\u003e bool {\n                node.attributes()\n                    .get(key)\n                    .filter(|entry| -\u003e bool { *entry == value })\n                    .is_some()\n            })\n            .collect::\u003cVec\u003c\u0026Node\u003e\u003e()\n    }\n}\n\nimpl Graph {\n    pub fn edge_count(\u0026self) -\u003e usize {\n        self.edges.len()\n    }\n\n    pub fn get_edge(\u0026self, id: \u0026str) -\u003e Option\u003c\u0026Edge\u003e {\n        self.edges.get(id)\n    }\n\n    pub fn create_edge(\n        \u0026mut self,\n        relation: \u0026str,\n        attributes: Attributes,\n        source_id: \u0026str,\n        destination_id: \u0026str,\n    ) -\u003e \u0026Edge {\n        let e = Edge::new(\n            String::from(relation),\n            String::from(source_id),\n            String::from(destination_id),\n            attributes,\n        );\n        let edge_id = e.id().clone();\n        self.edges.insert(e.id().clone(), e);\n\n        let edge = self.edges.get(\u0026edge_id).unwrap();\n\n        let connection_key = util::build_relation_key(source_id, destination_id);\n        let relations_map = self\n            .relations\n            .entry(connection_key)\n            .or_insert_with(HashMap::new);\n\n        relations_map.insert(String::from(relation), edge_id);\n\n        edge\n    }\n\n    pub fn remove_edge(\u0026mut self, edge_id: \u0026str) {\n        let removed_edge = self.edges.remove(edge_id).unwrap();\n        let relation_key = util::build_relation_key(removed_edge.from_id(), removed_edge.to_id());\n        let relations = self.relations.get_mut(\u0026relation_key).unwrap();\n        relations.remove(removed_edge.relation());\n        if relations.is_empty() {\n            self.relations.remove(\u0026relation_key);\n        }\n    }\n\n    pub fn has_any_relation(\u0026self, source_id: \u0026str, destination_id: \u0026str) -\u003e bool {\n        let relation_key = util::build_relation_key(source_id, destination_id);\n        self.relations.contains_key(\u0026relation_key)\n            \u0026\u0026 !self.relations.get(\u0026relation_key).unwrap().is_empty()\n    }\n\n    pub fn has_relation(\u0026self, relation: \u0026str, source_id: \u0026str, destination_id: \u0026str) -\u003e bool {\n        let relation_key = util::build_relation_key(source_id, destination_id);\n        self.relations.contains_key(\u0026relation_key)\n            \u0026\u0026 self\n                .relations\n                .get(\u0026relation_key)\n                .unwrap()\n                .contains_key(relation)\n    }\n}\n","traces":[{"line":17,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":21,"coverable":54},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","graph","util.rs"],"content":"pub fn build_relation_key(source_id: \u0026str, destination_id: \u0026str) -\u003e String {\n    format!(\"{}-{}\", source_id, destination_id)\n}\n\n#[cfg(test)]\nmod tests {\n    #[test]\n    fn test_create_key() {\n        let key = super::build_relation_key(\"a\", \"b\");\n        assert_eq!(\"a-b\", key);\n    }\n\n    #[test]\n    fn test_direction_of_key() {\n        assert_ne!(\n            super::build_relation_key(\"a\", \"b\"),\n            super::build_relation_key(\"b\", \"a\")\n        );\n    }\n}\n","traces":[{"line":1,"address":[4517280],"length":1,"stats":{"Line":0},"fn_name":"build_relation_key"},{"line":2,"address":[4212999,4212613,4213144,4212918,4212525],"length":1,"stats":{"Line":16},"fn_name":null},{"line":8,"address":[4212464,4212357,4212352],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":10,"address":[4212668,4212706,4212800],"length":1,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[4212341,4212848,4212336],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":15,"address":[4213378,4213212,4213282],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":5,"coverable":6},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","src","model","node.rs"],"content":"use super::attributes::Attributes;\nuse nanoid::nanoid;\nuse std::hash::Hash;\n\n#[derive(Clone, Hash, PartialEq, Eq)]\npub struct Node {\n    id: String,\n    attributes: Attributes,\n}\n\nimpl Node {\n    pub fn new(attributes: Attributes) -\u003e Node {\n        Node {\n            id: nanoid!(),\n            attributes,\n        }\n    }\n\n    pub fn id(\u0026self) -\u003e \u0026String {\n        \u0026self.id\n    }\n\n    pub fn attributes(\u0026self) -\u003e \u0026Attributes {\n        \u0026self.attributes\n    }\n}\n","traces":[{"line":12,"address":[4539952],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":14,"address":[4541710],"length":1,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[4540112],"length":1,"stats":{"Line":0},"fn_name":"attributes"},{"line":24,"address":[],"length":0,"stats":{"Line":2},"fn_name":null}],"covered":3,"coverable":6},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","tests","attributes.rs"],"content":"use neuland::model::Attributes;\n\n#[test]\nfn test_attributes_creation() {\n    let attributes = Attributes::default();\n\n    assert_eq!(0, attributes.value_count());\n}\n\n#[test]\nfn test_set_and_get_value() {\n    let mut attributes = Attributes::default();\n    attributes.set(\"a\", String::from(\"b\"));\n\n    assert_eq!(attributes.get(\"a\").unwrap(), \"b\");\n}\n\n#[test]\nfn test_unknown_value() {\n    let mut attributes = Attributes::default();\n    attributes.set(\"x\", String::from(\"y\"));\n\n    assert!(attributes.get(\"a\").is_none());\n}\n\n#[test]\nfn test_remove_value() {\n    let mut attributes = Attributes::default();\n    attributes.set(\"a\", String::from(\"b\"));\n    attributes.remove(\"a\");\n\n    assert!(attributes.get(\"a\").is_none());\n}\n","traces":[{"line":4,"address":[4213973,4213968],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":7,"address":[4216454,4216387,4216577],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[4214000,4214005],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":13,"address":[4216828],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4216891,4216859,4216914,4216945,4217050],"length":1,"stats":{"Line":3},"fn_name":null},{"line":19,"address":[4213989,4213984],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":21,"address":[4217352],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[4217406,4217380,4217459],"length":1,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[4214016,4214021],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":29,"address":[4217720],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[4217748],"length":1,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[4217771,4217797,4217850],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":12,"coverable":12},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","tests","find.rs"],"content":"use neuland::model::Attributes;\nuse neuland::model::Graph;\n\n#[test]\nfn test_node_find_by_attributes() {\n    let mut graph = Graph::default();\n    let mut attributes_a = Attributes::default();\n    attributes_a.set(\"test\", String::from(\"a\"));\n    let mut attributes_b = Attributes::default();\n    attributes_b.set(\"test\", String::from(\"b\"));\n    let node_a = graph.create_node(attributes_a).clone();\n    let node_b = graph.create_node(attributes_b).clone();\n    let node_c = graph.create_node(Attributes::default()).clone();\n\n    let matches = graph.find_by_attribute(\"test\", \"a\");\n    assert_eq!(1, matches.len());\n    assert!(matches.contains(\u0026\u0026node_a));\n    assert!(!matches.contains(\u0026\u0026node_b));\n    assert!(!matches.contains(\u0026\u0026node_c));\n}\n","traces":[{"line":5,"address":[4216336,4216341,4216352],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":6,"address":[4216373],"length":1,"stats":{"Line":1},"fn_name":null},{"line":8,"address":[4216564],"length":1,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[4216781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[4216818],"length":1,"stats":{"Line":1},"fn_name":null},{"line":12,"address":[4217032],"length":1,"stats":{"Line":1},"fn_name":null},{"line":13,"address":[4217335],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4217463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":16,"address":[4217518,4218077,4218210],"length":1,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[4217552,4217605,4218233],"length":1,"stats":{"Line":2},"fn_name":null},{"line":18,"address":[4218259,4217629,4217677],"length":1,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[4218285,4217749,4217701],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":12,"coverable":12},{"path":["/","home","floric","Dev","Github","rust-tests","graph-db","tests","graph.rs"],"content":"use neuland::model::Attributes;\nuse neuland::model::Graph;\n\n#[test]\nfn test_graph_creation() {\n    let graph = Graph::default();\n\n    assert_eq!(0, graph.node_count());\n}\n\n#[test]\nfn test_node_creation() {\n    let mut graph = Graph::default();\n    let node_a = graph.create_node(Attributes::default()).clone();\n    let node_b = graph.create_node(Attributes::default()).clone();\n\n    assert_eq!(21, node_a.id().len());\n    assert_eq!(21, node_b.id().len());\n    assert_ne!(node_a.id(), node_b.id());\n    assert_eq!(2, graph.node_count());\n    assert!(!graph.has_any_relation(node_a.id(), node_b.id()));\n}\n\n#[test]\nfn test_edge_creation() {\n    let mut graph = Graph::default();\n\n    let node_a = graph.create_node(Attributes::default()).clone();\n    let node_b = graph.create_node(Attributes::default()).clone();\n    let edge_a = graph\n        .create_edge(\"rel-a\", Attributes::default(), node_a.id(), node_b.id())\n        .clone();\n    graph.create_edge(\"rel-b\", Attributes::default(), node_a.id(), node_b.id());\n\n    assert!(graph.has_any_relation(node_a.id(), node_b.id()));\n    assert!(!graph.has_any_relation(node_b.id(), node_a.id()));\n    assert!(!graph.has_any_relation(node_a.id(), node_a.id()));\n    assert!(graph.has_relation(\"rel-a\", node_a.id(), node_b.id()));\n    assert!(graph.has_relation(\"rel-b\", node_a.id(), node_b.id()));\n    assert!(!graph.has_relation(\"rel-c\", node_a.id(), node_b.id()));\n    assert_eq!(21, edge_a.id().len());\n    assert_eq!(node_a.id(), edge_a.from_id());\n    assert_eq!(node_b.id(), edge_a.to_id());\n    assert_eq!(2, graph.node_count());\n    assert_eq!(2, graph.edge_count());\n}\n\n#[test]\nfn test_edge_removal() {\n    let mut graph = Graph::default();\n\n    let node_a = graph.create_node(Attributes::default()).clone();\n    let node_b = graph.create_node(Attributes::default()).clone();\n    let edge = graph\n        .create_edge(\"rel-a\", Attributes::default(), node_a.id(), node_b.id())\n        .clone();\n    graph.create_edge(\"rel-b\", Attributes::default(), node_a.id(), node_b.id());\n    graph.remove_edge(edge.id());\n\n    assert!(!graph.has_relation(\"rel-a\", node_a.id(), node_b.id()));\n    assert!(graph.has_relation(\"rel-b\", node_a.id(), node_b.id()));\n    assert_eq!(2, graph.node_count());\n    assert_eq!(1, graph.edge_count());\n    assert!(graph.has_any_relation(node_a.id(), node_b.id()));\n}\n","traces":[{"line":5,"address":[4215104,4215120,4215109],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":6,"address":[4215133],"length":1,"stats":{"Line":1},"fn_name":null},{"line":8,"address":[4215141,4215310,4215204],"length":1,"stats":{"Line":1},"fn_name":null},{"line":12,"address":[4215413,4215408,4215424],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":13,"address":[4215444],"length":1,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[4215574],"length":1,"stats":{"Line":1},"fn_name":null},{"line":15,"address":[4215836],"length":1,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[4215998,4216528,4216425,4215988],"length":1,"stats":{"Line":2},"fn_name":null},{"line":18,"address":[4216551,4216028,4216018,4216654],"length":1,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[4216051,4216781,4216685,4216117],"length":1,"stats":{"Line":2},"fn_name":null},{"line":20,"address":[4216804,4216907,4216131],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[4216927,4216160,4216178,4216199],"length":1,"stats":{"Line":3},"fn_name":null},{"line":25,"address":[4217088,4217104,4217093],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":26,"address":[4217126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[4217274],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[4217563],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[4217881],"length":1,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[4220214,4217868,4217847],"length":1,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[4220196,4218068,4218081,4218047],"length":1,"stats":{"Line":3},"fn_name":null},{"line":35,"address":[4219543,4218156,4218177,4218135],"length":1,"stats":{"Line":3},"fn_name":null},{"line":36,"address":[4218247,4218205,4219572,4218226],"length":1,"stats":{"Line":3},"fn_name":null},{"line":37,"address":[4219601,4218275,4218317,4218296],"length":1,"stats":{"Line":3},"fn_name":null},{"line":38,"address":[4218345,4218366,4218379,4219630],"length":1,"stats":{"Line":3},"fn_name":null},{"line":39,"address":[4218452,4218465,4218431,4219659],"length":1,"stats":{"Line":3},"fn_name":null},{"line":40,"address":[4218517,4218551,4219688,4218538],"length":1,"stats":{"Line":3},"fn_name":null},{"line":41,"address":[4218603,4219717,4218613,4219826],"length":1,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[4219247,4218636,4218705,4219145],"length":1,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[4219278,4218719,4219380,4218788],"length":1,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[4219958,4218802,4219849],"length":1,"stats":{"Line":1},"fn_name":null},{"line":45,"address":[4220087,4219978,4218831],"length":1,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[4226933,4226928],"length":1,"stats":{"Line":2},"fn_name":"call_once\u003cclosure-0,()\u003e"},{"line":50,"address":[4220342],"length":1,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[4220478],"length":1,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[4220746],"length":1,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[4221039],"length":1,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[4222445,4221012,4221033],"length":1,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[4221195,4222430,4221216],"length":1,"stats":{"Line":2},"fn_name":null},{"line":58,"address":[4221292,4221271],"length":1,"stats":{"Line":2},"fn_name":null},{"line":60,"address":[4221336,4221306,4222018,4221327],"length":1,"stats":{"Line":3},"fn_name":null},{"line":61,"address":[4221425,4221395,4222047,4221416],"length":1,"stats":{"Line":3},"fn_name":null},{"line":62,"address":[4222178,4222076,4221484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[4222301,4222199,4221513],"length":1,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[4222319,4221563,4221542,4221584],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":43,"coverable":43}]};
    </script>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
    <script>const e = React.createElement;

function pathToString(path) {
  if (path[0] === '/') {
    return '/' + path.slice(1).join('/');
  } else {
    return path.join('/');
  }
}

function findCommonPath(files) {
  if (!files || !files.length) {
    return [];
  }

  function isPrefix(arr, prefix) {
    if (arr.length < prefix.length) {
      return false;
    }
    for (let i = prefix.length - 1; i >= 0; --i) {
      if (arr[i] !== prefix[i]) {
        return false;
      }
    }
    return true;
  }

  let commonPath = files[0].path.slice(0, -1);
  while (commonPath.length) {
    if (files.every(file => isPrefix(file.path, commonPath))) {
      break;
    }
    commonPath.pop();
  }
  return commonPath;
}

function findFolders(files) {
  if (!files || !files.length) {
    return [];
  }

  let folders = files.filter(file => file.path.length > 1).map(file => file.path[0]);
  folders = [...new Set(folders)]; // unique
  folders.sort();

  folders = folders.map(folder => {
    let filesInFolder = files
      .filter(file => file.path[0] === folder)
      .map(file => ({
        ...file,
        path: file.path.slice(1),
        parent: [...file.parent, file.path[0]],
      }));

    const children = findFolders(filesInFolder); // recursion

    return {
      is_folder: true,
      path: [folder],
      parent: files[0].parent,
      children,
      covered: children.reduce((sum, file) => sum + file.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.coverable, 0),
      prevRun: {
        covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
        coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
      }
    };
  });

  return [
    ...folders,
    ...files.filter(file => file.path.length === 1),
  ];
}

class App extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {
      current: [],
    };
  }

  componentDidMount() {
    this.updateStateFromLocation();
    window.addEventListener("hashchange", () => this.updateStateFromLocation(), false);
  }

  updateStateFromLocation() {
    if (window.location.hash.length > 1) {
      const current = window.location.hash.substr(1).split('/');
      this.setState({current});
    } else {
      this.setState({current: []});
    }
  }

  getCurrentPath() {
    let file = this.props.root;
    let path = [file];
    for (let p of this.state.current) {
      file = file.children.find(file => file.path[0] === p);
      if (!file) {
        return path;
      }
      path.push(file);
    }
    return path;
  }

  render() {
    const path = this.getCurrentPath();
    const file = path[path.length - 1];

    let w = null;
    if (file.is_folder) {
      w = e(FilesList, {
        folder: file,
        onSelectFile: this.selectFile.bind(this),
        onBack: path.length > 1 ? this.back.bind(this) : null,
      });
    } else {
      w = e(DisplayFile, {
        file,
        onBack: this.back.bind(this),
      });
    }

    return e('div', {className: 'app'}, w);
  }

  selectFile(file) {
    this.setState(({current}) => {
      return {current: [...current, file.path[0]]};
    }, () => this.updateHash());
  }

  back(file) {
    this.setState(({current}) => {
      return {current: current.slice(0, current.length - 1)};
    }, () => this.updateHash());
  }

  updateHash() {
    if (!this.state.current || !this.state.current.length) {
      window.location = '#';
    } else {
      window.location = '#' + this.state.current.join('/');
    }
  }
}

function FilesList({folder, onSelectFile, onBack}) {
  let files = folder.children;
  return e('div', {className: 'display-folder'},
    e(FileHeader, {file: folder, onBack}),
    e('table', {className: 'files-list'},
      e('thead', {className: 'files-list__head'},
        e('tr', null,
          e('th', null, "Path"),
          e('th', null, "Coverage")
        )
      ),
      e('tbody', {className: 'files-list__body'},
        files.map(file => e(File, {file, onClick: onSelectFile}))
      )
    )
  );
}

function File({file, onClick}) {
  const coverage = file.coverable ? file.covered / file.coverable * 100 : -1;
  const coverageDelta = file.prevRun &&
    (file.covered / file.coverable * 100 - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('tr', {
      className: 'files-list__file'
        + (coverage >= 0 && coverage < 50 ? ' files-list__file_low': '')
        + (coverage >= 50 && coverage < 80 ? ' files-list__file_medium': '')
        + (coverage >= 80 ? ' files-list__file_high': '')
        + (file.is_folder ? ' files-list__file_folder': ''),
      onClick: () => onClick(file),
    },
    e('td', null, pathToString(file.path)),
    e('td', null,
      file.covered + ' / ' + file.coverable +
      (coverage >= 0 ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function DisplayFile({file, onBack}) {
  return e('div', {className: 'display-file'},
    e(FileHeader, {file, onBack}),
    e(FileContent, {file})
  );
}

function FileHeader({file, onBack}) {
  const coverage = file.covered / file.coverable * 100;
  const coverageDelta = file.prevRun && (coverage - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('div', {className: 'file-header'},
    onBack ? e('a', {className: 'file-header__back', onClick: onBack}, 'Back') : null,
    e('div', {className: 'file-header__name'}, pathToString([...file.parent, ...file.path])),
    e('div', {className: 'file-header__stat'},
      'Covered: ' + file.covered + ' of ' + file.coverable +
      (file.coverable ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function FileContent({file}) {
  return e('div', {className: 'file-content'},
    file.content.split(/\r?\n/).map((line, index) => {
      const trace = file.traces.find(trace => trace.line === index + 1);
      const covered = trace && trace.stats.Line;
      const uncovered = trace && !trace.stats.Line;
      return e('pre', {
          className: 'code-line'
            + (covered ? ' code-line_covered' : '')
            + (uncovered ? ' code-line_uncovered' : ''),
          title: trace ? JSON.stringify(trace.stats, null, 2) : null,
        }, line);
    })
  );
}

(function(){
  const commonPath = findCommonPath(data.files);
  const prevFilesMap = new Map();

  previousData && previousData.files.forEach((file) => {
    const path = file.path.slice(commonPath.length).join('/');
    prevFilesMap.set(path, file);
  });

  const files = data.files.map((file) => {
    const path = file.path.slice(commonPath.length);
    const { covered = 0, coverable = 0 } = prevFilesMap.get(path.join('/')) || {};
    return {
      ...file,
      path,
      parent: commonPath,
      prevRun: { covered, coverable },
    };
  });

  const children = findFolders(files);

  const root = {
    is_folder: true,
    children,
    path: commonPath,
    parent: [],
    covered: children.reduce((sum, file) => sum + file.covered, 0),
    coverable: children.reduce((sum, file) => sum + file.coverable, 0),
    prevRun: {
      covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
    }
  };

  ReactDOM.render(e(App, {root, prevFilesMap}), document.getElementById('root'));
}());
</script>
</body>
</html>